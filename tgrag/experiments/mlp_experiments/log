args= Namespace(target='weak_label', text_emb_path='/network/scratch/a/abdallah/hsh_projects/CrediGraph/data/weaksupervision', gnn_emb_path='/network/scratch/a/abdallah/hsh_projects/CrediGraph/data/weaksupervision', weaksupervision_path='/network/scratch/a/abdallah/hsh_projects/CrediGraph/data/weaksupervision', embed_type='text', emb_model='embeddinggemma-300m', batch_size=5000, test_valid_size=0.4, emb_dim=256, max_iter=200, lr=0.01, epochs=20, plots_out_path='/network/scratch/a/abdallah/hsh_projects/CrediGraph/plots', runs=1, use_gnn_emb=False, agg_month_emb=False, use_topic_emb=False, filter_by_GNN_nodes=False, MultiHead=False, num_classes=2, generate_weaksupervision_scores=False, month='dec', library='pytorch')
emb-size= 256
X_train_feat.shape=(256,)
Epoch=0	 Batch=0	 train_loss=0.7062827348709106	 valid_loss=0.7064071893692017	 test_loss=0.706407368183136
Epoch=0	 Batch=80845	 train_loss=0.7061806917190552	 valid_loss=0.7063385248184204	 test_loss=0.7063387036323547
Epoch=0	 Batch=161690	 train_loss=0.7068530917167664	 valid_loss=0.7062724232673645	 test_loss=0.706272542476654
Epoch=0	 Batch=242535	 train_loss=0.706132173538208	 valid_loss=0.7062068581581116	 test_loss=0.7062070369720459
Epoch=0	 Batch=323380	 train_loss=0.7059105634689331	 valid_loss=0.7061412334442139	 test_loss=0.7061415314674377
Epoch=0	 Batch=404225	 train_loss=0.8029629588127136	 valid_loss=0.7060751914978027	 test_loss=0.7060754299163818
Epoch=1	 Batch=0	 train_loss=0.7058908939361572	 valid_loss=0.7060128450393677	 test_loss=0.706013023853302
Epoch=1	 Batch=80845	 train_loss=0.7057943344116211	 valid_loss=0.7059494256973267	 test_loss=0.705949604511261
Epoch=1	 Batch=161690	 train_loss=0.7064573168754578	 valid_loss=0.7058846950531006	 test_loss=0.7058848738670349
Epoch=1	 Batch=242535	 train_loss=0.7057449817657471	 valid_loss=0.7058186531066895	 test_loss=0.7058188915252686
Epoch=1	 Batch=323380	 train_loss=0.7055239677429199	 valid_loss=0.7057514190673828	 test_loss=0.7057515978813171
Epoch=1	 Batch=404225	 train_loss=0.8012667298316956	 valid_loss=0.7056828737258911	 test_loss=0.7056831121444702
Epoch=2	 Batch=0	 train_loss=0.7054942846298218	 valid_loss=0.7056137919425964	 test_loss=0.7056140303611755
Epoch=2	 Batch=80845	 train_loss=0.7053914070129395	 valid_loss=0.7055437564849854	 test_loss=0.7055439352989197
Epoch=2	 Batch=161690	 train_loss=0.7060363292694092	 valid_loss=0.7054727077484131	 test_loss=0.7054728865623474
Epoch=2	 Batch=242535	 train_loss=0.7053278088569641	 valid_loss=0.7054004073143005	 test_loss=0.7054005265235901
Epoch=2	 Batch=323380	 train_loss=0.7051031589508057	 valid_loss=0.7053269743919373	 test_loss=0.705327033996582
Epoch=2	 Batch=404225	 train_loss=0.7993295192718506	 valid_loss=0.7052522897720337	 test_loss=0.7052524089813232
Epoch=3	 Batch=0	 train_loss=0.7050595879554749	 valid_loss=0.7051764726638794	 test_loss=0.7051765322685242
Epoch=3	 Batch=80845	 train_loss=0.7049501538276672	 valid_loss=0.7050994634628296	 test_loss=0.7050994634628296
Epoch=3	 Batch=161690	 train_loss=0.7055748105049133	 valid_loss=0.70502108335495	 test_loss=0.70502108335495
Epoch=3	 Batch=242535	 train_loss=0.70486980676651	 valid_loss=0.7049413919448853	 test_loss=0.7049413919448853
Epoch=3	 Batch=323380	 train_loss=0.7046401500701904	 valid_loss=0.7048601508140564	 test_loss=0.7048600912094116
Epoch=3	 Batch=404225	 train_loss=0.7972167134284973	 valid_loss=0.7047774195671082	 test_loss=0.7047773599624634
Epoch=4	 Batch=0	 train_loss=0.7045790553092957	 valid_loss=0.7046931385993958	 test_loss=0.7046929597854614
Epoch=4	 Batch=80845	 train_loss=0.7044611573219299	 valid_loss=0.7046072483062744	 test_loss=0.7046070694923401
Epoch=4	 Batch=161690	 train_loss=0.7050624489784241	 valid_loss=0.7045196294784546	 test_loss=0.7045194506645203
Epoch=4	 Batch=242535	 train_loss=0.7043601274490356	 valid_loss=0.7044302821159363	 test_loss=0.7044300436973572
Epoch=4	 Batch=323380	 train_loss=0.7041231393814087	 valid_loss=0.7043391466140747	 test_loss=0.7043388485908508
Epoch=4	 Batch=404225	 train_loss=0.7948856353759766	 valid_loss=0.7042459845542908	 test_loss=0.7042456269264221
Epoch=5	 Batch=0	 train_loss=0.7040400505065918	 valid_loss=0.7041508555412292	 test_loss=0.7041504979133606
Epoch=5	 Batch=80845	 train_loss=0.703911304473877	 valid_loss=0.7040536999702454	 test_loss=0.7040532827377319
Epoch=5	 Batch=161690	 train_loss=0.7044856548309326	 valid_loss=0.7039546370506287	 test_loss=0.7039542198181152
Epoch=5	 Batch=242535	 train_loss=0.7037856578826904	 valid_loss=0.7038542628288269	 test_loss=0.7038539052009583
Epoch=5	 Batch=323380	 train_loss=0.7035422921180725	 valid_loss=0.7037535309791565	 test_loss=0.7037531137466431
Epoch=5	 Batch=404225	 train_loss=0.7923393845558167	 valid_loss=0.7036528587341309	 test_loss=0.703652560710907
Epoch=6	 Batch=0	 train_loss=0.7034450173377991	 valid_loss=0.7035523056983948	 test_loss=0.7035520076751709
Epoch=6	 Batch=80845	 train_loss=0.7033131122589111	 valid_loss=0.7034514546394348	 test_loss=0.7034510970115662
Epoch=6	 Batch=161690	 train_loss=0.7038673758506775	 valid_loss=0.7033495306968689	 test_loss=0.7033491730690002
Epoch=6	 Batch=242535	 train_loss=0.7031795382499695	 valid_loss=0.7032470107078552	 test_loss=0.7032466530799866
Epoch=6	 Batch=323380	 train_loss=0.7029447555541992	 valid_loss=0.7031505107879639	 test_loss=0.7031501531600952
Epoch=6	 Batch=404225	 train_loss=0.7898263931274414	 valid_loss=0.7030723690986633	 test_loss=0.7030724883079529
Epoch=7	 Batch=0	 train_loss=0.7029106616973877	 valid_loss=0.7030133008956909	 test_loss=0.7030139565467834
Epoch=7	 Batch=80845	 train_loss=0.7028332352638245	 valid_loss=0.7029663920402527	 test_loss=0.70296710729599
Epoch=7	 Batch=161690	 train_loss=0.7034308910369873	 valid_loss=0.7029240727424622	 test_loss=0.702924907207489
Epoch=7	 Batch=242535	 train_loss=0.7028177976608276	 valid_loss=0.7028822898864746	 test_loss=0.7028833031654358
Epoch=7	 Batch=323380	 train_loss=0.7026389241218567	 valid_loss=0.7028393745422363	 test_loss=0.7028404474258423
Epoch=7	 Batch=404225	 train_loss=0.7878209948539734	 valid_loss=0.7027943730354309	 test_loss=0.7027955055236816
Epoch=8	 Batch=0	 train_loss=0.7026466727256775	 valid_loss=0.7027462720870972	 test_loss=0.7027472257614136
Epoch=8	 Batch=80845	 train_loss=0.7025617361068726	 valid_loss=0.7026928067207336	 test_loss=0.70269376039505
Epoch=8	 Batch=161690	 train_loss=0.7031283974647522	 valid_loss=0.7026311159133911	 test_loss=0.7026321887969971
Epoch=8	 Batch=242535	 train_loss=0.7024953961372375	 valid_loss=0.7025593519210815	 test_loss=0.7025601863861084
Epoch=8	 Batch=323380	 train_loss=0.7022810578346252	 valid_loss=0.7024780511856079	 test_loss=0.7024788856506348
Epoch=8	 Batch=404225	 train_loss=0.7855935096740723	 valid_loss=0.7023890614509583	 test_loss=0.7023897767066956
Epoch=9	 Batch=0	 train_loss=0.7021984457969666	 valid_loss=0.7022944688796997	 test_loss=0.702295184135437
Epoch=9	 Batch=80845	 train_loss=0.7020672559738159	 valid_loss=0.7021948099136353	 test_loss=0.7021957039833069
Epoch=9	 Batch=161690	 train_loss=0.702576220035553	 valid_loss=0.7020911574363708	 test_loss=0.7020920515060425
Epoch=9	 Batch=242535	 train_loss=0.7019209265708923	 valid_loss=0.7019839286804199	 test_loss=0.7019851207733154
Epoch=9	 Batch=323380	 train_loss=0.7016808986663818	 valid_loss=0.7018736600875854	 test_loss=0.701874852180481
Epoch=9	 Batch=404225	 train_loss=0.7828190922737122	 valid_loss=0.7017605304718018	 test_loss=0.701761782169342
Epoch=10	 Batch=0	 train_loss=0.7015537619590759	 valid_loss=0.7016452550888062	 test_loss=0.7016462683677673
Epoch=10	 Batch=80845	 train_loss=0.701403796672821	 valid_loss=0.7015276551246643	 test_loss=0.7015285491943359
Epoch=10	 Batch=161690	 train_loss=0.7018770575523376	 valid_loss=0.7014074921607971	 test_loss=0.701408326625824
Epoch=10	 Batch=242535	 train_loss=0.7012224197387695	 valid_loss=0.7012845873832703	 test_loss=0.701285183429718
Epoch=10	 Batch=323380	 train_loss=0.700969934463501	 valid_loss=0.7011586427688599	 test_loss=0.7011591196060181
Epoch=10	 Batch=404225	 train_loss=0.7795906662940979	 valid_loss=0.7010293006896973	 test_loss=0.7010294795036316
Epoch=11	 Batch=0	 train_loss=0.7008090615272522	 valid_loss=0.700896143913269	 test_loss=0.700896143913269
Epoch=11	 Batch=80845	 train_loss=0.7006396055221558	 valid_loss=0.7007590532302856	 test_loss=0.7007588744163513
Epoch=11	 Batch=161690	 train_loss=0.7010692954063416	 valid_loss=0.7006174921989441	 test_loss=0.7006171345710754
Epoch=11	 Batch=242535	 train_loss=0.700410008430481	 valid_loss=0.7004713416099548	 test_loss=0.7004708647727966
Epoch=11	 Batch=323380	 train_loss=0.7001368999481201	 valid_loss=0.7003202438354492	 test_loss=0.7003196477890015
Epoch=11	 Batch=404225	 train_loss=0.776040256023407	 valid_loss=0.7001643776893616	 test_loss=0.7001635432243347
Epoch=12	 Batch=0	 train_loss=0.6999214291572571	 valid_loss=0.7000033855438232	 test_loss=0.7000023722648621
Epoch=12	 Batch=80845	 train_loss=0.6997236013412476	 valid_loss=0.6998373866081238	 test_loss=0.699836254119873
Epoch=12	 Batch=161690	 train_loss=0.7000986933708191	 valid_loss=0.6996663212776184	 test_loss=0.6996650695800781
Epoch=12	 Batch=242535	 train_loss=0.6994299292564392	 valid_loss=0.6994902491569519	 test_loss=0.6994886994361877
Epoch=12	 Batch=323380	 train_loss=0.6991313099861145	 valid_loss=0.6993088126182556	 test_loss=0.6993070840835571
Epoch=12	 Batch=404225	 train_loss=0.7720786929130554	 valid_loss=0.6991218328475952	 test_loss=0.699120044708252
Epoch=13	 Batch=0	 train_loss=0.6988537311553955	 valid_loss=0.6989293098449707	 test_loss=0.6989271640777588
Epoch=13	 Batch=80845	 train_loss=0.698623538017273	 valid_loss=0.6987307667732239	 test_loss=0.6987285017967224
Epoch=13	 Batch=161690	 train_loss=0.698936939239502	 valid_loss=0.6985262036323547	 test_loss=0.6985237002372742
Epoch=13	 Batch=242535	 train_loss=0.6982560753822327	 valid_loss=0.6983155012130737	 test_loss=0.6983126997947693
Epoch=13	 Batch=323380	 train_loss=0.6979269981384277	 valid_loss=0.6980986595153809	 test_loss=0.6980955600738525
Epoch=13	 Batch=404225	 train_loss=0.7676275372505188	 valid_loss=0.6978752017021179	 test_loss=0.6978718042373657
Epoch=14	 Batch=0	 train_loss=0.6975765228271484	 valid_loss=0.6976446509361267	 test_loss=0.6976410746574402
Epoch=14	 Batch=80845	 train_loss=0.6973051428794861	 valid_loss=0.6974048614501953	 test_loss=0.6974008679389954
Epoch=14	 Batch=161690	 train_loss=0.6975405216217041	 valid_loss=0.6971535086631775	 test_loss=0.6971490979194641
Epoch=14	 Batch=242535	 train_loss=0.6968302726745605	 valid_loss=0.6968896389007568	 test_loss=0.6968848705291748
Epoch=14	 Batch=323380	 train_loss=0.6964476704597473	 valid_loss=0.6966138482093811	 test_loss=0.69660884141922
Epoch=14	 Batch=404225	 train_loss=0.7624981999397278	 valid_loss=0.696327269077301	 test_loss=0.6963217854499817
Epoch=15	 Batch=0	 train_loss=0.695972740650177	 valid_loss=0.6960315704345703	 test_loss=0.6960256099700928
Epoch=15	 Batch=80845	 train_loss=0.6956369280815125	 valid_loss=0.6957271695137024	 test_loss=0.6957208514213562
Epoch=15	 Batch=161690	 train_loss=0.6957732439041138	 valid_loss=0.6954142451286316	 test_loss=0.6954073905944824
Epoch=15	 Batch=242535	 train_loss=0.6950339674949646	 valid_loss=0.6950929760932922	 test_loss=0.6950858235359192
Epoch=15	 Batch=323380	 train_loss=0.6946042776107788	 valid_loss=0.6947635412216187	 test_loss=0.6947558522224426
Epoch=15	 Batch=404225	 train_loss=0.7565413117408752	 valid_loss=0.6944259405136108	 test_loss=0.6944176554679871
Epoch=16	 Batch=0	 train_loss=0.6940326690673828	 valid_loss=0.6940804123878479	 test_loss=0.6940717697143555
Epoch=16	 Batch=80845	 train_loss=0.6936487555503845	 valid_loss=0.6937271356582642	 test_loss=0.693717896938324
Epoch=16	 Batch=161690	 train_loss=0.6936931014060974	 valid_loss=0.693366289138794	 test_loss=0.6933566927909851
Epoch=16	 Batch=242535	 train_loss=0.6929396390914917	 valid_loss=0.692998468875885	 test_loss=0.692988395690918
Epoch=16	 Batch=323380	 train_loss=0.6924716830253601	 valid_loss=0.6926240921020508	 test_loss=0.6926135420799255
Epoch=16	 Batch=404225	 train_loss=0.7498394846916199	 valid_loss=0.6922439336776733	 test_loss=0.6922329068183899
Epoch=17	 Batch=0	 train_loss=0.6918249726295471	 valid_loss=0.6918587684631348	 test_loss=0.6918473839759827
Epoch=17	 Batch=80845	 train_loss=0.6914048194885254	 valid_loss=0.6914693117141724	 test_loss=0.6914575099945068
Epoch=17	 Batch=161690	 train_loss=0.6913668513298035	 valid_loss=0.6910750865936279	 test_loss=0.6910631656646729
Epoch=17	 Batch=242535	 train_loss=0.6906169652938843	 valid_loss=0.6906757354736328	 test_loss=0.6906633377075195
Epoch=17	 Batch=323380	 train_loss=0.6901258826255798	 valid_loss=0.6902703046798706	 test_loss=0.6902574300765991
Epoch=17	 Batch=404225	 train_loss=0.7424707412719727	 valid_loss=0.6898583173751831	 test_loss=0.6898449659347534
Epoch=18	 Batch=0	 train_loss=0.6894220113754272	 valid_loss=0.6894397139549255	 test_loss=0.6894258856773376
Epoch=18	 Batch=80845	 train_loss=0.6889646053314209	 valid_loss=0.6890139579772949	 test_loss=0.6889996528625488
Epoch=18	 Batch=161690	 train_loss=0.688833475112915	 valid_loss=0.6885806918144226	 test_loss=0.6885657906532288
Epoch=18	 Batch=242535	 train_loss=0.6880810856819153	 valid_loss=0.6881394982337952	 test_loss=0.6881241202354431
Epoch=18	 Batch=323380	 train_loss=0.6875540614128113	 valid_loss=0.6876901984214783	 test_loss=0.6876740455627441
Epoch=18	 Batch=404225	 train_loss=0.7344219088554382	 valid_loss=0.6872321367263794	 test_loss=0.6872155070304871
Epoch=19	 Batch=0	 train_loss=0.6867662668228149	 valid_loss=0.6867660880088806	 test_loss=0.686748743057251
Epoch=19	 Batch=80845	 train_loss=0.6867310404777527	 valid_loss=0.6867660880088806	 test_loss=0.686748743057251
Epoch=19	 Batch=161690	 train_loss=0.6869905591011047	 valid_loss=0.6867660880088806	 test_loss=0.686748743057251
Epoch=19	 Batch=242535	 train_loss=0.6867077350616455	 valid_loss=0.6867660880088806	 test_loss=0.686748743057251
Epoch=19	 Batch=323380	 train_loss=0.6866328120231628	 valid_loss=0.6867660880088806	 test_loss=0.686748743057251
Epoch=19	 Batch=404225	 train_loss=0.7330095171928406	 valid_loss=0.6867660880088806	 test_loss=0.686748743057251
Accuracy: 0.4635
cm: [[    0 72295]
 [    0 62448]]
F1 score: 0.2935
Run0:MSE=0.5365399122238159	R2=-1.1576833724975586	MAE=0.5365399122238159	Mean_MAE=0.4634600684265602	min_error_dict={'true': 1.0, 'pred': 1.0, 'diff': 0.0, 'test_idx': np.int64(2), 'domain': 'acg-architects.com'}	max_error_dict={'true': 0.0, 'pred': 1.0, 'diff': 1.0, 'test_idx': np.int64(0), 'domain': 'heeddigital.com'}
MSE: Mean=0.5365399122238159	std=nan
MAE: Mean=0.5365399122238159	std=nan
R2: Mean=-1.1576833724975586	std=nan
Mean_MAE: Mean=0.4634600684265602	std=nan
